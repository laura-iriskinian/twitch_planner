# TwitchPlanner

Application web permettant aux streamers de crÃ©er et gÃ©rer leurs plannings de stream avec export en image PNG.

## ğŸ“‹ PrÃ©requis

Avant de commencer, assurez-vous d'avoir installÃ© :

- [Node.js](https://nodejs.org/) (version 18 ou supÃ©rieure)
- [Docker Desktop](https://www.docker.com/products/docker-desktop) (pour PostgreSQL)
- [Git](https://git-scm.com/)

## ğŸš€ Installation

### 1. Cloner le projet

```bash
git clone <URL_DU_REPO>
cd twitch_planner
```

### 2. Configuration de la base de donnÃ©es (PostgreSQL avec Docker)

#### CrÃ©er le fichier .env pour Docker

Ã€ la **racine du projet** (lÃ  oÃ¹ se trouve `docker-compose.yml`), crÃ©ez un fichier `.env` :

```bash
# Ã€ la racine du projet (pas dans backend/)
cp .env.example .env
```

Puis Ã©ditez le fichier `.env` et **changez le mot de passe** :

```env
# Base de donnÃ©es PostgreSQL
DB_PASSWORD=VOTRE_MOT_DE_PASSE_SECURISE

# Backend (Ã  copier aussi dans backend/.env)
DATABASE_URL="postgresql://postgres:VOTRE_MOT_DE_PASSE_SECURISE@localhost:5433/twitchplanner"
JWT_SECRET="GENERER_UNE_CLE_ALEATOIRE_32_CARACTERES"
PORT=5000
NODE_ENV=development
```

**ğŸ’¡ GÃ©nÃ©rer un JWT_SECRET sÃ©curisÃ© :**

```bash
# Sur Linux/Mac
openssl rand -base64 32

# Sur Windows PowerShell
-join ((65..90) + (97..122) + (48..57) | Get-Random -Count 32 | % {[char]$_})
```

#### DÃ©marrer PostgreSQL avec Docker Compose

```bash
# Ã€ la racine du projet
docker-compose up -d
```

**VÃ©rifier que la base de donnÃ©es fonctionne :**

```bash
docker-compose ps
```

Vous devriez voir :
```
NAME              IMAGE         STATUS
twitch-postgres   postgres:15   Up About a minute (healthy)
```

#### Commandes Docker Compose utiles

```bash
# DÃ©marrer
docker-compose up -d

# ArrÃªter
docker-compose down

# Voir les logs
docker-compose logs postgres

# ArrÃªter et SUPPRIMER les donnÃ©es
docker-compose down -v
```

### 3. Configuration du Backend

#### Aller dans le dossier backend

```bash
cd backend
```

#### Installer les dÃ©pendances

```bash
npm install
```

#### CrÃ©er le fichier .env du backend

Copiez le fichier `.env` de la racine vers le dossier `backend` :

```bash
# Depuis le dossier backend/
cp ../.env .env
```

Ou crÃ©ez-le manuellement avec le mÃªme contenu que celui de la racine :

```env
DATABASE_URL="postgresql://postgres:VOTRE_MOT_DE_PASSE_SECURISE@localhost:5433/twitchplanner"
JWT_SECRET="VOTRE_CLE_JWT_SECURISEE"
PORT=5000
NODE_ENV=development
```

**âš ï¸ IMPORTANT - SÃ©curitÃ© :**
- Utilisez le **mÃªme mot de passe** que dans le `.env` de la racine
- Le fichier `.env` est dÃ©jÃ  dans `.gitignore` - ne le commitez jamais !

#### Initialiser la base de donnÃ©es avec Prisma

```bash
# GÃ©nÃ©rer le client Prisma
npx prisma generate

# CrÃ©er les tables dans la base de donnÃ©es
npx prisma db push
```

#### DÃ©marrer le serveur backend

```bash
npm run dev
```

Le serveur backend devrait dÃ©marrer sur `http://localhost:5000`

Vous devriez voir :
```
Server running on http://localhost:5000
```

### 4. Configuration du Frontend

#### Ouvrir un NOUVEAU terminal et aller dans le dossier frontend

```bash
cd frontend
```

#### Installer les dÃ©pendances

```bash
npm install
```

#### DÃ©marrer le serveur frontend

```bash
npm run dev
```

Le serveur frontend devrait dÃ©marrer sur `http://localhost:5173`

Vous devriez voir :
```
  VITE v5.x.x  ready in xxx ms

  âœ  Local:   http://localhost:5173/
```

## ğŸ¯ Utilisation

1. Ouvrez votre navigateur et allez sur `http://localhost:5173`
2. CrÃ©ez un compte
3. Connectez-vous
4. CrÃ©ez votre premier planning
5. Ajoutez des Ã©vÃ©nements/streams Ã  votre planning
6. Exportez votre planning en image PNG

## ğŸ—‚ï¸ Structure du projet

```
twitch_planner/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â””â”€â”€ schema.prisma          # SchÃ©ma de la base de donnÃ©es
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/           # Logique mÃ©tier
â”‚   â”‚   â”œâ”€â”€ middlewares/           # Middlewares (auth, etc.)
â”‚   â”‚   â”œâ”€â”€ routes/                # Routes de l'API
â”‚   â”‚   â””â”€â”€ utils/                 # Utilitaires (validation, JWT)
â”‚   â”œâ”€â”€ server.js                  # Point d'entrÃ©e du serveur
â”‚   â”œâ”€â”€ .env                       # Variables d'environnement (Ã  crÃ©er)
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/            # Composants React
â”‚   â”‚   â”œâ”€â”€ context/               # Context API (AuthContext)
â”‚   â”‚   â”œâ”€â”€ pages/                 # Pages de l'application
â”‚   â”‚   â”œâ”€â”€ utils/                 # Utilitaires (axios config)
â”‚   â”‚   â”œâ”€â”€ App.jsx                # Composant principal
â”‚   â”‚   â””â”€â”€ main.jsx               # Point d'entrÃ©e
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docker-compose.yml             # Configuration Docker
â”œâ”€â”€ .env                           # Variables d'environnement (Ã  crÃ©er)
â”œâ”€â”€ .env.example                   # Exemple de variables d'environnement
â”œâ”€â”€ .gitignore                     # Fichiers Ã  ignorer par Git
â””â”€â”€ README.md
```

## ğŸ“¦ Technologies utilisÃ©es

### Backend
- **Node.js** + **Express** : Serveur backend
- **Prisma** : ORM pour PostgreSQL
- **PostgreSQL** : Base de donnÃ©es relationnelle
- **JWT** : Authentification
- **bcrypt** : Hashage des mots de passe

### Frontend
- **React** + **Vite** : Framework frontend
- **React Router** : Navigation
- **Axios** : RequÃªtes HTTP
- **Tailwind CSS** : Styling
- **html2canvas** : Export PNG

## ğŸ”§ Commandes utiles

### Backend

```bash
# DÃ©marrer le serveur
npm run dev

# Voir la base de donnÃ©es avec Prisma Studio
npx prisma studio

# RÃ©initialiser la base de donnÃ©es
npx prisma db push --force-reset

# GÃ©nÃ©rer le client Prisma (aprÃ¨s modification du schema)
npx prisma generate
```

### Frontend

```bash
# DÃ©marrer le serveur de dÃ©veloppement
npm run dev

# Build pour la production
npm run build

# PrÃ©visualiser le build de production
npm run preview
```

### Docker (PostgreSQL)

```bash
# DÃ©marrer la base de donnÃ©es
docker-compose up -d

# ArrÃªter la base de donnÃ©es
docker-compose down

# Voir les logs
docker-compose logs postgres

# Suivre les logs en temps rÃ©el
docker-compose logs -f postgres

# Voir le statut
docker-compose ps

# Supprimer les donnÃ©es (âš ï¸ destructif)
docker-compose down -v
```

## ğŸ› RÃ©solution de problÃ¨mes

### Le backend ne dÃ©marre pas

**Erreur : `Cannot connect to database`**
- VÃ©rifiez que Docker Desktop est dÃ©marrÃ©
- VÃ©rifiez que PostgreSQL tourne : `docker-compose ps`
- VÃ©rifiez que le mot de passe dans `.env` correspond

**Erreur : `Prisma Client not generated`**
```bash
npx prisma generate
```

### Le frontend ne se connecte pas au backend

**Erreur : `Network Error` ou `CORS`**
- VÃ©rifiez que le backend tourne sur le port 5000
- VÃ©rifiez l'URL dans `frontend/src/utils/axios.js`

### Erreur lors de la crÃ©ation d'Ã©vÃ©nements

**Erreur : `404 Not Found`**
- VÃ©rifiez que dans `server.js` la route est bien `/api/events` (avec un S)

### Le container Docker ne dÃ©marre pas

**Erreur : `port is already allocated`**
- Un autre service utilise le port 5433
- Changez le port dans `docker-compose.yml` ET dans `.env`

Dans `docker-compose.yml` :
```yaml
ports:
  - "5434:5432"  # Changez 5433 en 5434
```

Dans `.env` :
```env
DATABASE_URL="postgresql://postgres:VOTRE_MDP@localhost:5434/twitchplanner"
```

## ğŸ“ FonctionnalitÃ©s

- âœ… Authentification (inscription, connexion, dÃ©connexion)
- âœ… Gestion du profil (email, mot de passe, URL Twitch, logo)
- âœ… CrÃ©ation de plannings avec dates de dÃ©but et fin
- âœ… Ajout d'Ã©vÃ©nements/streams avec :
  - Nom du jeu
  - Image du jeu
  - Titre du stream (optionnel)
  - Jour de la semaine
  - Heure de dÃ©but et fin
- âœ… Vue calendrier hebdomadaire avec affichage dynamique des jours
- âœ… Modification et suppression d'Ã©vÃ©nements
- âœ… Export du planning en image PNG
- âœ… Interface responsive

## ğŸ‘¨â€ğŸ’» Auteur

Laura IRISKINIAN - Projet B3 Keyce Academy 2025/2026

## ğŸ“„ Licence

Ce projet est rÃ©alisÃ© dans le cadre d'un projet acadÃ©mique.